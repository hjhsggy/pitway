## Redis单线程模型理解

- 访问一次redis需要客户端发送命令, redis 服务器执行命令, 返回执行结果
- 对于redis服务端来说, 执行redis命令时是单线程处理的, 到达服务端的命令会进入一个队列中, 逐个执行, 不会有两个命令同时执行, 不会有并发问题

## 缓存穿透,缓存击穿,缓存雪崩

- 缓存穿透

  - 成因: 一个不存在的key, 请求直接访问DB, 请求较多时造成DB宕机
  - 解决: 
    1. 把不存在的值也写入缓存, 可以设置一个较短的过期时间
    2. 布隆过滤器, 用一个足够大的bitmap用于存储访问的key, 不存在的直接被过滤掉

- 缓存击穿

  - 成因: 一个过期的key,大量请求访问DB造成压力
  - 解决:
    1. 访在访问key之前，采用SETNX来设置另一个短期key来锁住当前key的访问，访问结束再删除该短期key
    2. 分布式锁, 但会造成性能问题

- 缓存雪崩

  - 成因: 大量key同一时间过期,造成瞬时DB请求瞬间增大
  - 解决:
    1. 设置缓存过期时间为随机值, 避免大量缓存同时过期

